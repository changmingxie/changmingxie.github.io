{
  "filename": "deploy-server.md",
  "__html": "<h1 id=\"dashboard-server%E6%A8%A1%E5%BC%8F%E9%83%A8%E7%BD%B2\">dashboard server模式部署 <a class=\"header-anchor\" href=\"#dashboard-server%E6%A8%A1%E5%BC%8F%E9%83%A8%E7%BD%B2\">#</a></h1>\n<p>存储模式为server模式，即通过调用server来实现存储操作。\n另外此模式支持任务管理，需要配置quartz cluster数据库链接</p>\n<h2 id=\"%E5%89%8D%E7%BD%AE%E6%9D%A1%E4%BB%B6\">前置条件 <a class=\"header-anchor\" href=\"#%E5%89%8D%E7%BD%AE%E6%9D%A1%E4%BB%B6\">#</a></h2>\n<p>初始化<a href=\"https://github.com/changmingxie/tcc-transaction/blob/master-2.x/tcc-transaction-server/src/main/dbscripts/db_init.sql\">quartz数据库脚本</a><br>\n<a href=\"/zh-cn/docs/ops/tccserver/index.html\">server部署</a></p>\n<h2 id=\"%E5%AE%89%E8%A3%85%E5%B9%B6%E9%83%A8%E7%BD%B2\">安装并部署 <a class=\"header-anchor\" href=\"#%E5%AE%89%E8%A3%85%E5%B9%B6%E9%83%A8%E7%BD%B2\">#</a></h2>\n<p>下载最新<a href=\"https://github.com/changmingxie/tcc-transaction/releases\">RELEASE</a>版本</p>\n<h3 id=\"linux%2Fmac%E7%8E%AF%E5%A2%83\">linux/mac环境 <a class=\"header-anchor\" href=\"#linux%2Fmac%E7%8E%AF%E5%A2%83\">#</a></h3>\n<p><strong>创建dashboard目录</strong></p>\n<pre><code class=\"language-shell\">makdir dashboard \ncd  dashboard  \n</code></pre>\n<p><strong>下载tcc-transaction-dashboard-xxx.tar.gz</strong>，解压到dashboard目录</p>\n<pre><code class=\"language-shell\">dashboard % tar zxvf tcc-transaction-dashboard-2.0.0.tar.gz \nx conf/application.yaml\nx lib/tcc-transaction-dashboard.jar\nx conf/\nx conf/logback.xml\nx bin/\nx bin/startup.sh\nx bin/startup.cmd\nx bin/shutdown.sh\nx bin/shutdown.cmd\ndashboard % tree\n.\n├── bin\n│         ├── shutdown.cmd\n│         ├── shutdown.sh\n│         ├── startup.cmd\n│         └── startup.sh\n├── conf\n│         ├── application.yaml\n│         └── logback.xml\n├── lib\n│         └── tcc-transaction-dashboard.jar\n└── tcc-transaction-dashboard-2.0.0.tar.gz\n\n3 directories, 8 files\ndashboard % \n</code></pre>\n<p>conf/application.yaml配置<a href=\"/zh-cn/docs/tutorial/configurations.html#dashbaord\">详见</a></p>\n<p><strong>启动dashboard</strong></p>\n<pre><code class=\"language-shell\">sh bin/startup.sh\n</code></pre>\n<h3 id=\"windows%E7%8E%AF%E5%A2%83\">windows环境 <a class=\"header-anchor\" href=\"#windows%E7%8E%AF%E5%A2%83\">#</a></h3>\n<ul>\n<li>创建dashboard目录。</li>\n<li>下载tcc-transaction-dashboard-xxx.zip，到dashboard目录，并解压。</li>\n<li>双击bin/startup.cmd，启动dashboard。</li>\n<li>双击bin/shutdown.cmd，停止dashboard。</li>\n</ul>\n<h3 id=\"%E6%89%93%E5%BC%80dashbaord\">打开dashbaord <a class=\"header-anchor\" href=\"#%E6%89%93%E5%BC%80dashbaord\">#</a></h3>\n<p>默认地址为：<a href=\"http://localhost:22332/tcc-transaction-dashboard\">http://localhost:22332/tcc-transaction-dashboard</a><br>\n默认用户名密码: admin/123456\n<img src=\"../../img/dashboard/tcc_dashboard_not_login.jpg\" alt=\"首页\"></p>\n<h2 id=\"%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83\">注册中心 <a class=\"header-anchor\" href=\"#%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83\">#</a></h2>\n<p>server模式下，需要和server服务交互。<br>\n<strong>注意</strong>: dashboard选择nacos或者zookeeper注册中心，前提是server端以对应的注册中心来暴露。<br>\n这里提供了三种server服务发现的方式：</p>\n<ul>\n<li>direct(默认)</li>\n<li>nacos</li>\n<li>zookeeper</li>\n</ul>\n<h3 id=\"direct(%E9%BB%98%E8%AE%A4)\">direct(默认) <a class=\"header-anchor\" href=\"#direct(%E9%BB%98%E8%AE%A4)\">#</a></h3>\n<p>application.yaml可如下配置</p>\n<pre><code class=\"language-yaml\"><span class=\"hljs-attr\">server:</span>\n  <span class=\"hljs-attr\">servlet:</span>\n    <span class=\"hljs-attr\">context-path:</span> <span class=\"hljs-string\">/tcc-transaction-dashboard</span>\n  <span class=\"hljs-attr\">port:</span> <span class=\"hljs-number\">22332</span>\n\n<span class=\"hljs-attr\">logging:</span>\n  <span class=\"hljs-attr\">level:</span>\n    <span class=\"hljs-attr\">root:</span> <span class=\"hljs-string\">info</span>\n<span class=\"hljs-attr\">spring:</span>\n  <span class=\"hljs-attr\">application:</span>\n    <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">tcc-transaction-dashboard</span>\n  <span class=\"hljs-attr\">tcc:</span>\n    <span class=\"hljs-attr\">dashboard:</span>\n      <span class=\"hljs-attr\">userName:</span> <span class=\"hljs-string\">admin</span>\n      <span class=\"hljs-attr\">password:</span> <span class=\"hljs-number\">123456</span>\n      <span class=\"hljs-attr\">connection-mode:</span> <span class=\"hljs-string\">server</span>\n      <span class=\"hljs-attr\">registry:</span> <span class=\"hljs-comment\"># connection-mode为server时使用</span>\n        <span class=\"hljs-attr\">registry-type:</span> <span class=\"hljs-string\">direct</span>\n        <span class=\"hljs-attr\">direct:</span>\n          <span class=\"hljs-attr\">server-addresses:</span> <span class=\"hljs-string\">http://localhost:12332</span>\n    <span class=\"hljs-attr\">recovery:</span>\n      <span class=\"hljs-attr\">quartz-clustered:</span> <span class=\"hljs-literal\">true</span>\n      <span class=\"hljs-attr\">quartz-data-source-url:</span> <span class=\"hljs-string\">jdbc:mysql://localhost:3306/TCC_SERVER?useSSL=false&amp;allowPublicKeyRetrieval=true</span>\n      <span class=\"hljs-attr\">quartz-data-source-driver:</span> <span class=\"hljs-string\">com.mysql.jdbc.Driver</span>\n      <span class=\"hljs-attr\">quartz-data-source-user:</span> <span class=\"hljs-string\">root</span>\n      <span class=\"hljs-attr\">quartz-data-source-password:</span> <span class=\"hljs-string\">welcome1</span>\n\n</code></pre>\n<h3 id=\"nacos\">nacos <a class=\"header-anchor\" href=\"#nacos\">#</a></h3>\n<p>需要<a href=\"https://nacos.io/zh-cn/docs/deployment.html\">安装nacos</a><br>\napplication.yaml可如下配置</p>\n<pre><code class=\"language-yaml\"><span class=\"hljs-attr\">server:</span>\n  <span class=\"hljs-attr\">servlet:</span>\n    <span class=\"hljs-attr\">context-path:</span> <span class=\"hljs-string\">/tcc-transaction-dashboard</span>\n  <span class=\"hljs-attr\">port:</span> <span class=\"hljs-number\">22332</span>\n\n<span class=\"hljs-attr\">logging:</span>\n  <span class=\"hljs-attr\">level:</span>\n    <span class=\"hljs-attr\">root:</span> <span class=\"hljs-string\">info</span>\n<span class=\"hljs-attr\">spring:</span>\n  <span class=\"hljs-attr\">application:</span>\n    <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">tcc-transaction-dashboard</span>\n  <span class=\"hljs-attr\">tcc:</span>\n    <span class=\"hljs-attr\">dashboard:</span>\n      <span class=\"hljs-attr\">userName:</span> <span class=\"hljs-string\">admin</span>\n      <span class=\"hljs-attr\">password:</span> <span class=\"hljs-number\">123456</span>\n      <span class=\"hljs-attr\">connection-mode:</span> <span class=\"hljs-string\">server</span>\n      <span class=\"hljs-attr\">registry:</span> <span class=\"hljs-comment\"># connection-mode为server时使用</span>\n        <span class=\"hljs-attr\">registry-type:</span> <span class=\"hljs-string\">nacos</span>\n        <span class=\"hljs-attr\">nacos:</span>\n          <span class=\"hljs-attr\">server-addr:</span> <span class=\"hljs-string\">localhost:8848</span>\n    <span class=\"hljs-attr\">recovery:</span>\n      <span class=\"hljs-attr\">quartz-clustered:</span> <span class=\"hljs-literal\">true</span>\n      <span class=\"hljs-attr\">quartz-data-source-url:</span> <span class=\"hljs-string\">jdbc:mysql://localhost:3306/TCC_SERVER?useSSL=false&amp;allowPublicKeyRetrieval=true</span>\n      <span class=\"hljs-attr\">quartz-data-source-driver:</span> <span class=\"hljs-string\">com.mysql.jdbc.Driver</span>\n      <span class=\"hljs-attr\">quartz-data-source-user:</span> <span class=\"hljs-string\">root</span>\n      <span class=\"hljs-attr\">quartz-data-source-password:</span> <span class=\"hljs-string\">welcome1</span>\n\n</code></pre>\n<h3 id=\"zookeeper\">zookeeper <a class=\"header-anchor\" href=\"#zookeeper\">#</a></h3>\n<p>需要安装zookeeper<br>\napplication.yaml可如下配置</p>\n<pre><code class=\"language-yaml\"><span class=\"hljs-attr\">server:</span>\n  <span class=\"hljs-attr\">servlet:</span>\n    <span class=\"hljs-attr\">context-path:</span> <span class=\"hljs-string\">/tcc-transaction-dashboard</span>\n  <span class=\"hljs-attr\">port:</span> <span class=\"hljs-number\">22332</span>\n\n<span class=\"hljs-attr\">logging:</span>\n  <span class=\"hljs-attr\">level:</span>\n    <span class=\"hljs-attr\">root:</span> <span class=\"hljs-string\">info</span>\n<span class=\"hljs-attr\">spring:</span>\n  <span class=\"hljs-attr\">application:</span>\n    <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">tcc-transaction-dashboard</span>\n  <span class=\"hljs-attr\">tcc:</span>\n    <span class=\"hljs-attr\">dashboard:</span>\n      <span class=\"hljs-attr\">userName:</span> <span class=\"hljs-string\">admin</span>\n      <span class=\"hljs-attr\">password:</span> <span class=\"hljs-number\">123456</span>\n      <span class=\"hljs-attr\">connection-mode:</span> <span class=\"hljs-string\">server</span>\n      <span class=\"hljs-attr\">registry:</span> <span class=\"hljs-comment\"># connection-mode为server时使用</span>\n        <span class=\"hljs-attr\">registry-type:</span> <span class=\"hljs-string\">zookeeper</span>\n        <span class=\"hljs-attr\">zookeeper:</span>\n          <span class=\"hljs-attr\">connect-string:</span> <span class=\"hljs-string\">localhost:2181</span>\n    <span class=\"hljs-attr\">recovery:</span>\n      <span class=\"hljs-attr\">quartz-clustered:</span> <span class=\"hljs-literal\">true</span>\n      <span class=\"hljs-attr\">quartz-data-source-url:</span> <span class=\"hljs-string\">jdbc:mysql://localhost:3306/TCC_SERVER?useSSL=false&amp;allowPublicKeyRetrieval=true</span>\n      <span class=\"hljs-attr\">quartz-data-source-driver:</span> <span class=\"hljs-string\">com.mysql.jdbc.Driver</span>\n      <span class=\"hljs-attr\">quartz-data-source-user:</span> <span class=\"hljs-string\">root</span>\n      <span class=\"hljs-attr\">quartz-data-source-password:</span> <span class=\"hljs-string\">welcome1</span>\n\n</code></pre>\n",
  "link": "/zh-cn/docs/ops/dashboard/deploy-server.html",
  "meta": {}
}