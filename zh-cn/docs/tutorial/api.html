<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="keywords" content="api" />
	<meta name="description" content="api" />
	<!-- 网页标签标题 -->
	<title>api</title>
	<link rel="shortcut icon" href="/img/tcc_logo.png"/>
	<link rel="stylesheet" href="/build/documentation.css" />
</head>
<body>
	<div id="root"><div class="documentation-page" data-reactroot=""><header class="header-container header-container-normal"><div class="header-body"><a href="/zh-cn/index.html"><img class="logo" src="/img/tcc_colorful.png"/></a><div class="search search-normal"><span class="icon-search"></span></div><div class="header-menu"><img class="header-menu-toggle" src="/img/system/menu_gray.png"/><ul><li class="menu-item menu-item-normal"><span><a href="/zh-cn/index.html" target="_self">首页</a></span></li><li class="menu-item menu-item-normal"><div class="nav-container"><div class="word"><a>文档</a></div><ul class="sub-nav-container" style="width:220px"><li><a href="/zh-cn/docs/what-is-tcctransaction.html" target="_self">TCC文档</a></li><li><a href="/zh-cn/aggdocs/what-is-aggregateframework.html" target="_self">AGG文档</a></li></ul></div></li><li class="menu-item menu-item-normal"><span><a href="/zh-cn/blog/index.html" target="_self">博客</a></span></li><li class="menu-item menu-item-normal"><span><a href="/zh-cn/community/index.html" target="_self">社区</a></span></li></ul></div></div></header><div class="bar"><div class="bar-body"><img src="/img/system/docs.png" class="front-img"/><span>TCC文档</span><img src="/img/system/docs.png" class="back-img"/></div></div><section class="content-section"><div class="sidemenu"><div class="sidemenu-toggle"><img src="https://img.alicdn.com/tfs/TB1E6apXHGYBuNjy0FoXXciBFXa-200-200.png"/></div><ul><li class="menu-item menu-item-level-1"><span>概述</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/what-is-tcctransaction.html" target="_self">TCC-TRANSACTION是什么</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/terminology.html" target="_self">术语</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/faq.html" target="_self">FAQ</a></li></ul></li><li class="menu-item menu-item-level-1"><span>用户指南</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><span>快速开始<img style="transform:rotate(-90deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/quickstart.html" target="_self">示例说明</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/quickstart/embedded-sample.html" target="_self">embedded模式示例</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/quickstart/server-sample.html" target="_self">server模式示例</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/tutorial/configurations.html" target="_self">参数配置</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/tutorial/api.html" target="_self">API支持</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><span>连接模式<img style="transform:rotate(-90deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/connectionmode/embedded.html" target="_self">embedded模式</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/connectionmode/server.html" target="_self">server模式</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><span>存储类型<img style="transform:rotate(-90deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/storagetype/memory.html" target="_self">memory</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/storagetype/rocksdb.html" target="_self">rocksdb</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/storagetype/jdbc.html" target="_self">jdbc</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/storagetype/redis.html" target="_self">redis</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/storagetype/shard-redis.html" target="_self">shard-redis</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/storagetype/redis-cluster.html" target="_self">redis-cluster</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/storagetype/remoting.html" target="_self">remoting</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/storagetype/custom.html" target="_self">custom</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><span>事件序列化<img style="transform:rotate(-90deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/serializer/index.html" target="_self">说明</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/serializer/kryo.html" target="_self">kryo</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/serializer/fastjson.html" target="_self">fastjson</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/serializer/custom.html" target="_self">custom</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><span>注册中心支持<img style="transform:rotate(-90deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/registry/index.html" target="_self">说明</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/registry/direct.html" target="_self">direct</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/registry/nacos.html" target="_self">nacos</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/registry/zookeeper.html" target="_self">zookeeper</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/registry/custom.html" target="_self">custom</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><span>RPC框架支持<img style="transform:rotate(-90deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/rpc/index.html" target="_self">说明</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/rpc/dubbo.html" target="_self">dubbo</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/rpc/openfeign.html" target="_self">openfeign</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/rpc/grpc.html" target="_self">grpc</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/tutorial/rpc/support-other-rpc.html" target="_self">扩展支持</a></li></ul></li></ul></li><li class="menu-item menu-item-level-1"><span>运维指南</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/ops/upgrade.html" target="_self">版本升级指南</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><span>server部署<img style="transform:rotate(-90deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/ops/server/index.html" target="_self">部署说明</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/ops/server/deploy-alone.html" target="_self">单机部署</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/ops/server/deploy-cluster.html" target="_self">集群部署</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><span>dashboard部署<img style="transform:rotate(-90deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/ops/dashboard/index.html" target="_self">部署说明</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/ops/dashboard/deploy-embedded.html" target="_self">embedded模式部署</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/ops/dashboard/deploy-server.html" target="_self">server模式部署</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/ops/dashboard/dashboard-guild.html" target="_self">dashboard使用手册</a></li></ul></li><li class="menu-item menu-item-level-1"><span>社区</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/community/community.html" target="_self">社区</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/community/tcc-transaction-dev.html" target="_self">开发者</a></li></ul></li></ul></div><div class="doc-content markdown-body"><h1 id="api%E6%94%AF%E6%8C%81">API支持 <a class="header-anchor" href="#api%E6%94%AF%E6%8C%81">#</a></h1>
<h2 id="%E6%A0%B8%E5%BF%83%E7%B1%BB">核心类 <a class="header-anchor" href="#%E6%A0%B8%E5%BF%83%E7%B1%BB">#</a></h2>
<h3 id="configurabletransactionaspect">ConfigurableTransactionAspect <a class="header-anchor" href="#configurabletransactionaspect">#</a></h3>
<p>分布式事务切面，用于对方法注解@Compensable的拦截，具体拦截逻辑见<strong>CompensableTransactionInterceptor</strong></p>
<h3 id="configurablecoordinatoraspect">ConfigurableCoordinatorAspect <a class="header-anchor" href="#configurablecoordinatoraspect">#</a></h3>
<p>事务协调切面，用于对方法注解@Compensable和@EnableTcc的拦截，具体拦截逻辑见<strong>ResourceCoordinatorInterceptor</strong><br>
<strong>注意</strong>：当遇到@Compensable时，切面执行顺序为ConfigurableTransactionAspect&gt;ConfigurableCoordinatorAspect</p>
<h3 id="compensabletransactioninterceptor">CompensableTransactionInterceptor <a class="header-anchor" href="#compensabletransactioninterceptor">#</a></h3>
<p>对注解@Compensable进行拦截，实现对主事务、分支事务的try-confirm-cancel流程。</p>
<h3 id="resourcecoordinatorinterceptor">ResourceCoordinatorInterceptor <a class="header-anchor" href="#resourcecoordinatorinterceptor">#</a></h3>
<p>对注解@Compensable或者@EnableTcc进行拦截，实现事件及参与方存储。</p>
<h3 id="transactioncontext">TransactionContext <a class="header-anchor" href="#transactioncontext">#</a></h3>
<p>事件上下文，分支事务场景用到。</p>
<pre><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TransactionContext</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Serializable</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> serialVersionUID = -<span class="hljs-number">8199390103169700387L</span>;
    <span class="hljs-comment">// 取自上一级事件参与方的事务ID，作为当前分支事件ID</span>
    <span class="hljs-keyword">private</span> Xid xid;
    <span class="hljs-comment">// 主事件ID</span>
    <span class="hljs-keyword">private</span> Xid rootXid;
    <span class="hljs-comment">// 主事件Domain</span>
    <span class="hljs-keyword">private</span> String rootDomain;
    <span class="hljs-comment">// 事件状态</span>
    <span class="hljs-keyword">private</span> TransactionStatus status = TransactionStatus.TRYING;
    <span class="hljs-comment">// 参与方状态</span>
    <span class="hljs-keyword">private</span> ParticipantStatus participantStatus = ParticipantStatus.TRYING;
    <span class="hljs-comment">// 扩展字段</span>
    <span class="hljs-keyword">private</span> Map&lt;String, String&gt; attachments = <span class="hljs-keyword">new</span> ConcurrentHashMap&lt;String, String&gt;();

}

</code></pre>
<h3 id="transaction">Transaction <a class="header-anchor" href="#transaction">#</a></h3>
<p>事件，每个事务都会产生一个事件。</p>
<pre><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Transaction</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Serializable</span> </span>{
    <span class="hljs-comment">// 参与方列表</span>
    <span class="hljs-keyword">private</span> List&lt;Participant&gt; participants = <span class="hljs-keyword">new</span> ArrayList&lt;Participant&gt;();
    <span class="hljs-comment">// 预留字段</span>
    <span class="hljs-keyword">private</span> Map&lt;String, Object&gt; attachments = <span class="hljs-keyword">new</span> ConcurrentHashMap&lt;String, Object&gt;();
    <span class="hljs-comment">// 事件ID</span>
    <span class="hljs-keyword">private</span> Xid xid;
    <span class="hljs-comment">// 主事件ID，当前事件为主事件时，xid = rootId</span>
    <span class="hljs-keyword">private</span> Xid rootXid;
    <span class="hljs-comment">// 主domain</span>
    <span class="hljs-keyword">private</span> String rootDomain;
    <span class="hljs-comment">// 事件类型，主事件-ROOT(1)，分支事件-BRANCH(2)</span>
    <span class="hljs-keyword">private</span> TransactionType transactionType;
    <span class="hljs-comment">// 事件状态，TRYING(1), CONFIRMING(2), CANCELLING(3), TRY_SUCCESS(11), TRY_FAILED(12);</span>
    <span class="hljs-keyword">private</span> TransactionStatus status;
    <span class="hljs-comment">// 事件创建时间</span>
    <span class="hljs-keyword">private</span> Date createTime = <span class="hljs-keyword">new</span> Date();
    <span class="hljs-comment">// 事件更新时间</span>
    <span class="hljs-keyword">private</span> Date lastUpdateTime = <span class="hljs-keyword">new</span> Date();
    <span class="hljs-comment">// 事件重试次数，记录事件补偿的次数</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-keyword">int</span> retriedCount = <span class="hljs-number">0</span>;
    <span class="hljs-comment">// 版本号</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">long</span> version = <span class="hljs-number">0L</span>;
    
    <span class="hljs-comment">// 添加参与方</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">enlistParticipant</span><span class="hljs-params">(Participant participant)</span> </span>{
        participants.add(participant);
    }
    <span class="hljs-comment">// 执行事件commit操作</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">commit</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">for</span> (Participant participant : participants) {
            <span class="hljs-keyword">if</span> (!participant.getStatus().equals(ParticipantStatus.CONFIRM_SUCCESS)) {
                participant.commit();
                participant.setStatus(ParticipantStatus.CONFIRM_SUCCESS);
            }
        }
    }

    <span class="hljs-comment">// 执行事件rollback操作</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">rollback</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">for</span> (Participant participant : participants) {
            <span class="hljs-keyword">if</span> (!participant.getStatus().equals(ParticipantStatus.CANCEL_SUCCESS)) {
                participant.rollback();
                participant.setStatus(ParticipantStatus.CANCEL_SUCCESS);
            }
        }
    }

}

</code></pre>
<h3 id="participant">Participant <a class="header-anchor" href="#participant">#</a></h3>
<p>参与方，一个事件有多个参与方。</p>
<pre><code class="language-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Participant</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Serializable</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> serialVersionUID = <span class="hljs-number">4127729421281425247L</span>;
    <span class="hljs-comment">// 主事件ID</span>
    <span class="hljs-keyword">private</span> Xid rootXid; 
    <span class="hljs-comment">// 主事件Domain</span>
    <span class="hljs-keyword">private</span> String rootDomain; 
    <span class="hljs-comment">// 参与方事件ID，分支事务时，作为目标分支事务的事件ID</span>
    <span class="hljs-keyword">private</span> Xid xid; 
    <span class="hljs-comment">// 方法调用上下文，执行confirm或cancel时用到</span>
    <span class="hljs-keyword">private</span> InvocationContext invocationContext; 
    <span class="hljs-comment">// TRYING(1), CONFIRMING(2), CANCELLING(3), TRY_SUCCESS(11), TRY_FAILED(12), CONFIRM_SUCCESS(21), CANCEL_SUCCESS(31);</span>
    <span class="hljs-keyword">private</span> ParticipantStatus status = ParticipantStatus.TRYING; 

    <span class="hljs-comment">// rollback操作，执行参与方cancel流程</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">rollback</span><span class="hljs-params">()</span> </span>{
        Terminator.invoke(<span class="hljs-keyword">new</span> TransactionContext(rootDomain, rootXid, xid, TransactionStatus.CANCELLING, status), <span class="hljs-keyword">new</span> Invocation(invocationContext.getCancelMethodName(), invocationContext), transactionContextEditorClass);
    }
    <span class="hljs-comment">// commit操作，执行参与方confirm流程</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">commit</span><span class="hljs-params">()</span> </span>{
        Terminator.invoke(<span class="hljs-keyword">new</span> TransactionContext(rootDomain, rootXid, xid, TransactionStatus.CONFIRMING, status), <span class="hljs-keyword">new</span> Invocation(invocationContext.getConfirmMethodName(), invocationContext), transactionContextEditorClass);
    }

}

</code></pre>
<pre><code class="language-java"><span class="hljs-comment">// 执行confirm或cancel时反射调用时用到</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InvocationContext</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Serializable</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> serialVersionUID = -<span class="hljs-number">7969140711432461165L</span>;
    <span class="hljs-keyword">private</span> Class targetClass;          <span class="hljs-comment">// 事务调用的目标类</span>
    <span class="hljs-keyword">private</span> String confirmMethodName;   <span class="hljs-comment">// confirm方法名</span>
    <span class="hljs-keyword">private</span> String cancelMethodName;    <span class="hljs-comment">// cancel方法名</span>
    <span class="hljs-keyword">private</span> Class[] parameterTypes;     <span class="hljs-comment">// 参数类型列表</span>
    <span class="hljs-keyword">private</span> Object[] args;              <span class="hljs-comment">// 参数列表</span>
}
</code></pre>
<h2 id="%E6%A0%B8%E5%BF%83%E6%B3%A8%E8%A7%A3">核心注解 <a class="header-anchor" href="#%E6%A0%B8%E5%BF%83%E6%B3%A8%E8%A7%A3">#</a></h2>
<h3 id="%40compensable">@Compensable <a class="header-anchor" href="#%40compensable">#</a></h3>
<p>此注解放在try方法上，用于定义tcc的执行逻辑，即try-confirm-cancel三阶段的实现，<strong>特别注意</strong>：confirm和cancel方法参数要与try保持一致
<strong>属性说明</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left"><div style="width:50px">参数名</div></th>
<th style="text-align:left"><div style="width:200px">含义</div></th>
<th style="text-align:left">类型</th>
<th style="text-align:left">可选值</th>
<th style="text-align:left">默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">propagation</td>
<td style="text-align:left">传播方式，预留字段，暂时没用到</td>
<td style="text-align:left">String</td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">confirmMethod</td>
<td style="text-align:left">confirm方法名</td>
<td style="text-align:left">String</td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">cancelMethod</td>
<td style="text-align:left">cancel方法名</td>
<td style="text-align:left">String</td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">asyncConfirm</td>
<td style="text-align:left">异步confirm</td>
<td style="text-align:left">boolean</td>
<td style="text-align:left"></td>
<td style="text-align:left">默认为false</td>
</tr>
<tr>
<td style="text-align:left">asyncCancel</td>
<td style="text-align:left">异步cancel</td>
<td style="text-align:left">boolean</td>
<td style="text-align:left"></td>
<td style="text-align:left">默认为false</td>
</tr>
</tbody>
</table>
<h3 id="%40enabletcc">@EnableTcc <a class="header-anchor" href="#%40enabletcc">#</a></h3>
<p>此注解用于声明tcc接口，用于远程调用时传递事件上下文(TransactionContext)</p>
<h3 id="%40uniqueidentity">@UniqueIdentity <a class="header-anchor" href="#%40uniqueidentity">#</a></h3>
<p>此注解作用于方法参数上，参数一般为订单号，可保证同一个订单并发请求是只产生一个事件，第二个请求时会报异常。<br>
使用可参考如下：</p>
<pre><code class="language-java">    <span class="hljs-meta">@Compensable</span>(confirmMethod = <span class="hljs-string">"confirmMakePayment"</span>, cancelMethod = <span class="hljs-string">"cancelMakePayment"</span>, asyncConfirm = <span class="hljs-keyword">false</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">makePayment</span><span class="hljs-params">(@UniqueIdentity String orderNo)</span> </span>{
        System.out.println(<span class="hljs-string">"order try make payment called.time seq:"</span> + DateFormatUtils.format(Calendar.getInstance(), <span class="hljs-string">"yyyy-MM-dd HH:mm:ss"</span>));

        Order order = orderRepository.findByMerchantOrderNo(orderNo);

        String result = capitalTradeOrderService.record(buildCapitalTradeOrderDto(order));
        String result2 = redPacketTradeOrderService.record(buildRedPacketTradeOrderDto(order));
    }
</code></pre>
</div></section><footer class="footer-container"><div class="footer-body"><div class="cols-container"><div class="col col-12"><h3>免责声明</h3><p>TCC-TRANSACTION是一款开源的微服务架构下的TCC型分布式事务解决方案，致力于提供高性能和简单易用的分布式事务服务。</p></div><div class="col col-6"><dl><dt>文档</dt><dd><a href="/zh-cn/docs/what-is-tcctransaction.html" target="_self">概览</a></dd><dd><a href="/zh-cn/docs/tutorial/quickstart.html" target="_self">快速开始</a></dd><dd><a href="/zh-cn/docs/tutorial/quickstart.html" target="_self">开发者指南</a></dd></dl></div><div class="col col-6"><dl><dt>资源</dt><dd><a href="/zh-cn/blog/index.html" target="_self">博客</a></dd><dd><a href="/zh-cn/community/index.html" target="_self">社区</a></dd></dl></div></div><div class="copyright"><span>Copyright © 2022 TCC-TRANSACTION</span></div></div></footer></div></div>
	<script src="https://f.alicdn.com/react/15.4.1/react-with-addons.min.js"></script>
	<script src="https://f.alicdn.com/react/15.4.1/react-dom.min.js"></script>
	<script>
		window.rootPath = '';
  </script>
	<script src="/build/documentation.js"></script>
</body>
</html>
