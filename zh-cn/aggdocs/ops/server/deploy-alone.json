{
  "filename": "deploy-alone.md",
  "__html": "<h1 id=\"server%E5%8D%95%E6%9C%BA%E9%83%A8%E7%BD%B2\">server单机部署 <a class=\"header-anchor\" href=\"#server%E5%8D%95%E6%9C%BA%E9%83%A8%E7%BD%B2\">#</a></h1>\n<p>适用于对可用要求不高的场景，比如测试环境，开发者本地测试。<br>\nserver支持注册中心有：</p>\n<ul>\n<li>direct(默认)</li>\n<li>nacos</li>\n<li>zookeeper</li>\n</ul>\n<p>server支持多种存储方式</p>\n<ul>\n<li>memory(默认)</li>\n<li>rocksdb</li>\n<li>jdbc</li>\n<li>redis</li>\n<li>shard-redis</li>\n<li>redis-cluster</li>\n</ul>\n<p>server支持对补偿任务的管理(quartz)</p>\n<ul>\n<li>quartz缓存模式</li>\n<li>quartz使用db,非集群模式</li>\n<li>quartz集群模式(默认)</li>\n</ul>\n<p>以下以注册中心[direct]+存储类型[memory]+任务部署类型[quartz集群模式]这种组合为例。</p>\n<h2 id=\"%E5%87%86%E5%A4%87%E9%98%B6%E6%AE%B5\">准备阶段 <a class=\"header-anchor\" href=\"#%E5%87%86%E5%A4%87%E9%98%B6%E6%AE%B5\">#</a></h2>\n<h3 id=\"%E5%88%9D%E5%A7%8B%E5%8C%96quartz%E6%95%B0%E6%8D%AE%E5%BA%93\">初始化quartz数据库 <a class=\"header-anchor\" href=\"#%E5%88%9D%E5%A7%8B%E5%8C%96quartz%E6%95%B0%E6%8D%AE%E5%BA%93\">#</a></h3>\n<p>这里使用mysql数据库，脚本请<a href=\"https://github.com/changmingxie/aggregate-framework/blob/master-4.x/aggregate-framework-server/src/main/dbscripts/db_init.sql\">查看</a></p>\n<h3 id=\"%E4%B8%8B%E8%BD%BD%E6%9C%80%E6%96%B0release%E7%89%88%E6%9C%AC\">下载最新<a href=\"https://github.com/changmingxie/aggregate-framework/releases\">RELEASE</a>版本 <a class=\"header-anchor\" href=\"#%E4%B8%8B%E8%BD%BD%E6%9C%80%E6%96%B0release%E7%89%88%E6%9C%AC\">#</a></h3>\n<p>下载最新的安装包aggregate-framework-server-xxx.tar.gz，依次</p>\n<h2 id=\"%E5%AE%89%E8%A3%85%E5%B9%B6%E5%90%AF%E5%8A%A8\">安装并启动 <a class=\"header-anchor\" href=\"#%E5%AE%89%E8%A3%85%E5%B9%B6%E5%90%AF%E5%8A%A8\">#</a></h2>\n<h3 id=\"linux%2Fmac%E7%8E%AF%E5%A2%83\">linux/mac环境 <a class=\"header-anchor\" href=\"#linux%2Fmac%E7%8E%AF%E5%A2%83\">#</a></h3>\n<p><strong>创建server目录</strong></p>\n<pre><code class=\"language-shell\">makdir server \ncd  server  \n</code></pre>\n<p><strong>下载aggregate-framework-server-xxx.tar.gz</strong>，解压到server目录</p>\n<pre><code class=\"language-shell\">server % tar zxvf aggregate-framework-server-4.0.0-SNAPSHOT.tar.gz\nx conf/application.yaml\nx lib/aggregate-framework-server.jar\nx conf/\nx conf/logback.xml\nx bin/\nx bin/startup.sh\nx bin/startup.cmd\nx bin/shutdown.sh\nx bin/shutdown.cmd\nserver % tree\n.\n├── aggregate-framework-server-4.0.0-SNAPSHOT.tar.gz\n├── bin\n│   ├── shutdown.cmd\n│   ├── shutdown.sh\n│   ├── startup.cmd\n│   └── startup.sh\n├── conf\n│   ├── application.yaml\n│   └── logback.xml\n└── lib\n    └── aggregate-framework-server.jar\n\n3 directories, 8 files\nserver % \n</code></pre>\n<p>conf/application.yaml<a href=\"/zh-cn/aggdocs/tutorial/configurations.html#server%E7%AB%AF\">详细配置详见</a><br>\n以下以注册中心[direct]+存储类型[memory]+任务部署类型[quartz集群模式]这种组合为例。application.yaml可如下配置：</p>\n<pre><code class=\"language-yaml\"><span class=\"hljs-attr\">server:</span>\n  <span class=\"hljs-attr\">port:</span> <span class=\"hljs-number\">12332</span>\n  <span class=\"hljs-attr\">servlet:</span>\n    <span class=\"hljs-attr\">context-path:</span> <span class=\"hljs-string\">/${spring.application.name}</span>\n<span class=\"hljs-attr\">spring:</span>\n  <span class=\"hljs-attr\">application:</span>\n    <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">aggregate-framework-server</span>\n  <span class=\"hljs-attr\">autoconfigure:</span>\n    <span class=\"hljs-attr\">exclude:</span>\n    <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration</span>\n  <span class=\"hljs-attr\">agg:</span>\n    <span class=\"hljs-attr\">storage:</span>\n      <span class=\"hljs-attr\">storage-type:</span> <span class=\"hljs-string\">memory</span>\n    <span class=\"hljs-attr\">recovery:</span>\n      <span class=\"hljs-attr\">quartz-clustered:</span> <span class=\"hljs-literal\">true</span>\n      <span class=\"hljs-attr\">quartz-data-source-url:</span> <span class=\"hljs-string\">jdbc:mysql://localhost:3306/AGG_SERVER?useSSL=false&amp;allowPublicKeyRetrieval=true</span>\n      <span class=\"hljs-attr\">quartz-data-source-driver:</span> <span class=\"hljs-string\">com.mysql.jdbc.Driver</span>\n      <span class=\"hljs-attr\">quartz-data-source-user:</span> <span class=\"hljs-string\">root</span>\n      <span class=\"hljs-attr\">quartz-data-source-password:</span> <span class=\"hljs-string\">welcome1</span>\n    <span class=\"hljs-attr\">registry:</span>\n      <span class=\"hljs-attr\">registry-type:</span> <span class=\"hljs-string\">direct</span>\n    <span class=\"hljs-attr\">remoting:</span>\n      <span class=\"hljs-attr\">listen-port:</span> <span class=\"hljs-number\">2332</span>\n<span class=\"hljs-attr\">logging:</span>\n  <span class=\"hljs-attr\">level:</span>\n    <span class=\"hljs-attr\">root:</span> <span class=\"hljs-string\">info</span>\n</code></pre>\n<p><strong>启动server</strong></p>\n<pre><code class=\"language-shell\">sh bin/startup.sh\n</code></pre>\n<p><strong>停止server</strong></p>\n<pre><code class=\"language-shell\">sh bin/shutdown.sh\n</code></pre>\n<h3 id=\"windows%E7%8E%AF%E5%A2%83\">windows环境 <a class=\"header-anchor\" href=\"#windows%E7%8E%AF%E5%A2%83\">#</a></h3>\n<ul>\n<li>创建server目录。</li>\n<li>下载aggregate-framework-server-xxx.zip，到server目录，并解压。</li>\n<li>双击bin/startup.cmd，启动server。</li>\n<li>双击bin/shutdown.cmd，停止server。</li>\n</ul>\n",
  "link": "/zh-cn/aggdocs/ops/server/deploy-alone.html",
  "meta": {}
}